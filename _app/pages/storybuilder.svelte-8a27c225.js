import{_ as pe}from"../chunks/preload-helper-ec9aa979.js";import{S as ge,i as ye,s as Ee,e as c,t as J,k as x,c as u,a as E,h as R,m as D,d as h,g as _e,H as t,j as be,w as ve,x as Te,b as e,y as we,T as he,Q as Se,q as xe,o as De,B as Ie,U as Le,v as Ne,V as Oe}from"../chunks/vendor-64152532.js";import{H as $e}from"../chunks/Header-6249a452.js";import{g as Pe}from"../chunks/leaflet-a05627c4.js";import{v as Ae}from"../chunks/variables-0cfc34e1.js";import"../chunks/version-38130bdd.js";import"../chunks/theme-f77c3cd3.js";function fe(m,l,s){const r=m.slice();return r[9]=l[s],r}function me(m){let l,s=m[9]+"",r,w,a;return{c(){l=c("option"),r=J(s),w=x(),this.h()},l(i){l=u(i,"OPTION",{});var n=E(l);r=R(n,s),w=D(n),n.forEach(h),this.h()},h(){l.__value=a=m[9],l.value=l.__value},m(i,n){_e(i,l,n),t(l,r),t(l,w)},p(i,n){n&4&&s!==(s=i[9]+"")&&be(r,s),n&4&&a!==(a=i[9])&&(l.__value=a,l.value=l.__value)},d(i){i&&h(l)}}}function je(m){let l,s,r,w,a,i,n,k,B,I,G,p,b,T,S,_,$,g,O,V,H,v,W,P,X,A,U,Y,Z,L,ee,F,te,j,ae,M,le,ne;s=new $e({});let q=m[2],f=[];for(let o=0;o<q.length;o+=1)f[o]=me(fe(m,q,o));return{c(){l=c("div"),ve(s.$$.fragment),r=x(),w=c("main"),a=c("form"),i=c("fieldset"),n=c("legend"),k=J("Title"),B=x(),I=c("input"),G=x(),p=c("fieldset"),b=c("legend"),T=J("Author's Username"),S=x(),_=c("input"),$=x(),g=c("fieldset"),O=c("legend"),V=J("Location"),H=x(),v=c("input"),W=x(),P=c("datalist");for(let o=0;o<f.length;o+=1)f[o].c();X=x(),A=c("fieldset"),U=c("legend"),Y=J("Description"),Z=x(),L=c("input"),ee=x(),F=c("section"),te=x(),j=c("button"),ae=J("Submit"),this.h()},l(o){l=u(o,"DIV",{class:!0});var N=E(l);Te(s.$$.fragment,N),r=D(N),w=u(N,"MAIN",{});var d=E(w);a=u(d,"FORM",{enctype:!0,method:!0,class:!0});var y=E(a);i=u(y,"FIELDSET",{});var Q=E(i);n=u(Q,"LEGEND",{class:!0});var se=E(n);k=R(se,"Title"),se.forEach(h),B=D(Q),I=u(Q,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),Q.forEach(h),G=D(y),p=u(y,"FIELDSET",{});var z=E(p);b=u(z,"LEGEND",{class:!0});var re=E(b);T=R(re,"Author's Username"),re.forEach(h),S=D(z),_=u(z,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),z.forEach(h),$=D(y),g=u(y,"FIELDSET",{});var C=E(g);O=u(C,"LEGEND",{class:!0});var ie=E(O);V=R(ie,"Location"),ie.forEach(h),H=D(C),v=u(C,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0,list:!0}),W=D(C),P=u(C,"DATALIST",{id:!0});var de=E(P);for(let oe=0;oe<f.length;oe+=1)f[oe].l(de);de.forEach(h),C.forEach(h),X=D(y),A=u(y,"FIELDSET",{});var K=E(A);U=u(K,"LEGEND",{class:!0});var ce=E(U);Y=R(ce,"Description"),ce.forEach(h),Z=D(K),L=u(K,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,maxlength:!0,class:!0}),K.forEach(h),ee=D(y),F=u(y,"SECTION",{class:!0,id:!0}),E(F).forEach(h),te=D(y),j=u(y,"BUTTON",{type:!0,class:!0});var ue=E(j);ae=R(ue,"Submit"),ue.forEach(h),y.forEach(h),d.forEach(h),N.forEach(h),this.h()},h(){e(n,"class","hidden"),e(I,"type","text"),e(I,"name","title"),e(I,"id","title"),e(I,"placeholder","Title"),I.required=!0,e(I,"class","w-full px-2 py-2 border placeholder:text-black"),e(b,"class","hidden"),e(_,"type","text"),e(_,"name","username"),e(_,"id","username"),e(_,"placeholder","Author's Username"),_.required=!0,e(_,"class","w-full px-2 py-2 border placeholder:text-black"),e(O,"class","hidden"),e(v,"type","text"),e(v,"name","location"),e(v,"id","location"),e(v,"placeholder","Add Location"),v.required=!0,e(v,"class","w-full px-2 py-2 border placeholder:text-black"),e(v,"list","location-suggestions"),e(P,"id","location-suggestions"),e(U,"class","hidden"),e(L,"type","text"),e(L,"name","description"),e(L,"id","desciption"),e(L,"placeholder","Brief description"),e(L,"maxlength","400"),L.required=!0,e(L,"class","w-full px-2 py-2 border placeholder:text-black"),e(F,"class","w-full placeholder:text-black"),e(F,"id","editor"),e(j,"type","submit"),e(j,"class","mt-auto p-2 self-center text-white font-display text-xs bg-black"),e(a,"enctype","multipart/form-data"),e(a,"method","post"),e(a,"class","flex flex-col gap-4 px-4 py-8 font-text text-sm leading-4"),e(l,"class","flex flex-col align-items-center gap-y-4 w-screen bg-primary text-center h-full overflow-y-scroll")},m(o,N){_e(o,l,N),we(s,l,null),t(l,r),t(l,w),t(w,a),t(a,i),t(i,n),t(n,k),t(i,B),t(i,I),t(a,G),t(a,p),t(p,b),t(b,T),t(p,S),t(p,_),t(a,$),t(a,g),t(g,O),t(O,V),t(g,H),t(g,v),he(v,m[0]),t(g,W),t(g,P);for(let d=0;d<f.length;d+=1)f[d].m(P,null);t(a,X),t(a,A),t(A,U),t(U,Y),t(A,Z),t(A,L),t(a,ee),t(a,F),t(a,te),t(a,j),t(j,ae),m[4](a),M=!0,le||(ne=Se(v,"input",m[3]),le=!0)},p(o,[N]){if(N&1&&v.value!==o[0]&&he(v,o[0]),N&4){q=o[2];let d;for(d=0;d<q.length;d+=1){const y=fe(o,q,d);f[d]?f[d].p(y,N):(f[d]=me(y),f[d].c(),f[d].m(P,null))}for(;d<f.length;d+=1)f[d].d(1);f.length=q.length}},i(o){M||(xe(s.$$.fragment,o),M=!0)},o(o){De(s.$$.fragment,o),M=!1},d(o){o&&h(l),Ie(s),Le(f,o),m[4](null),le=!1,ne()}}}function ke(m,l,s){const r=`${Ae.strapi_url}/api`;let w=[],a,i,n="",k=[];async function B(p){p.preventDefault();const b=new FormData(p.target),T={data:{username:b.get("username")}},S={data:{title:b.get("title"),location:b.get("location"),description:b.get("description")}};i.save().then(g=>{S.data.submission=g});const $=(await(await fetch(`${r}/authors`)).json()).data.filter(g=>g.attributes.username===T.data.username);if(console.log($),$.length>0)S.data.author=$[0].id,await(await fetch(`${r}/stories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).json();else{const g=await(await fetch(`${r}/authors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)})).json();S.data.author=g.data.id;const O=await(await fetch(`${r}/stories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).json(),V={data:{media:w}},H=await(await fetch(`${r}/stories/${O.data.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).json();console.log(H)}}Ne(async()=>{const p=(await pe(()=>import("../chunks/editor-189adb14.js").then(function(T){return T.e}),["chunks/editor-189adb14.js","chunks/vendor-64152532.js"])).default,b=(await pe(()=>import("../chunks/bundle-d5d2f378.js").then(function(T){return T.b}),["chunks/bundle-d5d2f378.js","chunks/vendor-64152532.js"])).default;console.log(b),a.addEventListener("submit",B),i=new p({holder:"editor",placeholder:"Add Storyblock",tools:{image:{class:b,config:{endpoints:{byFile:`${r}/upload`},uploader:{uploadByFile(T){const S=new FormData;return S.append("files",T,T.name),fetch(`${r}/upload`,{method:"POST",body:S}).then(_=>_.json()).then(_=>(w.push(_[0].id),{success:1,file:{url:_[0].url}}))}}}}}})});function I(){n=this.value,s(0,n)}function G(p){Oe[p?"unshift":"push"](()=>{a=p,s(1,a)})}return m.$$.update=()=>{m.$$.dirty&1&&Pe(n).then(p=>s(2,k=p))},[n,a,k,I,G]}class Ge extends ge{constructor(l){super();ye(this,l,ke,je,Ee,{})}}export{Ge as default};
