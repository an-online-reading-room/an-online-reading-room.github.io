import{S as xt,i as Ot,s as At,e as g,c as v,N as Ze,b as c,g as L,M as _e,d as i,O as lt,k as O,a as _,P as ot,m as A,H as d,t as he,h as me,Q as ee,j as Be,l as wt,U as Rt,w as P,x as H,y as W,q as B,o as R,B as z,R as Ke,T as Et,f as Ut,p as Me,v as qt,n as Pe,X as Xt,V as Qe}from"../../chunks/vendor-64152532.js";import{v as He}from"../../chunks/variables-0cfc34e1.js";import"../../chunks/theme-f77c3cd3.js";function jt(a){let t,e;return{c(){t=g("img"),this.h()},l(l){t=v(l,"IMG",{src:!0,alt:!0}),this.h()},h(){Ze(t.src,e=a[0])||c(t,"src",e),c(t,"alt",a[1])},m(l,r){L(l,t,r)},p(l,[r]){r&1&&!Ze(t.src,e=l[0])&&c(t,"src",e),r&2&&c(t,"alt",l[1])},i:_e,o:_e,d(l){l&&i(t)}}}function Yt(a,t,e){let{src:l}=t,{alt:r}=t;return a.$$set=s=>{"src"in s&&e(0,l=s.src),"alt"in s&&e(1,r=s.alt)},[l,r]}class F extends xt{constructor(t){super();Ot(this,t,Yt,jt,At,{src:0,alt:1})}}function yt(a,t,e){const l=a.slice();return l[64]=t[e],l}function $t(a,t,e){const l=a.slice();return l[67]=t[e],l}function It(a){let t,e=a[64].data.text+"",l,r,s,n,o;return{c(){t=g("section"),l=he(e),this.h()},l(h){t=v(h,"SECTION",{"data-content":!0,id:!0});var u=_(t);l=me(u,e),u.forEach(i),this.h()},h(){c(t,"data-content",r=a[64].data.text),c(t,"id",s="target_"+a[64].id)},m(h,u){L(h,t,u),d(t,l),n||(o=ee(t,"click",a[21]),n=!0)},p(h,u){u[0]&1&&e!==(e=h[64].data.text+"")&&Be(l,e),u[0]&1&&r!==(r=h[64].data.text)&&c(t,"data-content",r),u[0]&1&&s!==(s="target_"+h[64].id)&&c(t,"id",s)},d(h){h&&i(t),n=!1,o()}}}function Tt(a){let t,e,l,r,s;return{c(){t=g("div"),e=g("img"),this.h()},l(n){t=v(n,"DIV",{class:!0});var o=_(t);e=v(o,"IMG",{id:!0,src:!0,alt:!0}),o.forEach(i),this.h()},h(){c(e,"id",l="target_"+a[64].id),Ze(e.src,r=a[64].data.file.url)||c(e,"src",r),c(e,"alt",s=a[64].data.caption),c(t,"class","self-center flex-initial object-contain")},m(n,o){L(n,t,o),d(t,e)},p(n,o){o[0]&1&&l!==(l="target_"+n[64].id)&&c(e,"id",l),o[0]&1&&!Ze(e.src,r=n[64].data.file.url)&&c(e,"src",r),o[0]&1&&s!==(s=n[64].data.caption)&&c(e,"alt",s)},d(n){n&&i(t)}}}function Dt(a){let t,e,l=a[67].content+"",r,s,n;return{c(){t=g("section"),e=g("p"),r=he(l),s=O(),this.h()},l(o){t=v(o,"SECTION",{id:!0});var h=_(t);e=v(h,"P",{});var u=_(e);r=me(u,l),u.forEach(i),s=A(h),h.forEach(i),this.h()},h(){c(t,"id",n="anno-"+a[67].blockID)},m(o,h){L(o,t,h),d(t,e),d(e,r),d(t,s)},p(o,h){h[0]&1&&l!==(l=o[67].content+"")&&Be(r,l),h[0]&1&&n!==(n="anno-"+o[67].blockID)&&c(t,"id",n)},d(o){o&&i(t)}}}function Ct(a){let t,e=a[67].blockID==a[64].id&&Dt(a);return{c(){e&&e.c(),t=wt()},l(l){e&&e.l(l),t=wt()},m(l,r){e&&e.m(l,r),L(l,t,r)},p(l,r){l[67].blockID==l[64].id?e?e.p(l,r):(e=Dt(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){e&&e.d(l),l&&i(t)}}}function St(a){let t,e,l,r,s,n,o,h,u,$,w,b,E,D,p,y,C=a[64].data.text&&It(a),N=a[64].data.file&&Tt(a),j=a[0].annotations,x=[];for(let V=0;V<j.length;V+=1)x[V]=Ct($t(a,j,V));return{c(){t=g("div"),e=g("div"),l=lt("svg"),r=lt("path"),s=lt("path"),n=lt("path"),o=O(),h=g("div"),C&&C.c(),u=O(),N&&N.c(),$=O(),w=g("section"),b=g("div"),E=O(),D=g("div");for(let V=0;V<x.length;V+=1)x[V].c();y=O(),this.h()},l(V){t=v(V,"DIV",{class:!0});var q=_(t);e=v(q,"DIV",{class:!0});var S=_(e);l=ot(S,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var Q=_(l);r=ot(Q,"path",{d:!0,stroke:!0,"stroke-width":!0}),_(r).forEach(i),s=ot(Q,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0}),_(s).forEach(i),n=ot(Q,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0}),_(n).forEach(i),Q.forEach(i),S.forEach(i),o=A(q),h=v(q,"DIV",{class:!0});var G=_(h);C&&C.l(G),u=A(G),N&&N.l(G),$=A(G),w=v(G,"SECTION",{class:!0,id:!0});var ie=_(w);b=v(ie,"DIV",{class:!0}),_(b).forEach(i),E=A(ie),D=v(ie,"DIV",{class:!0});var ue=_(D);for(let J=0;J<x.length;J+=1)x[J].l(ue);ue.forEach(i),ie.forEach(i),G.forEach(i),y=A(q),q.forEach(i),this.h()},h(){c(r,"d","M12 20C12 15.5817 15.5817 12 20 12V12C24.4183 12 28 15.5817 28 20V25.0909C28 25.9375 28 26.3608 27.8739 26.6989C27.6712 27.2425 27.2425 27.6712 26.6989 27.8739C26.3608 28 25.9375 28 25.0909 28H20C15.5817 28 12 24.4183 12 20V20Z"),c(r,"stroke","#000"),c(r,"stroke-width","1.2"),c(s,"d","M17 19L23 19"),c(s,"stroke","#000"),c(s,"stroke-width","1.2"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(n,"d","M20 23H23"),c(n,"stroke","#000"),c(n,"stroke-width","1.2"),c(n,"stroke-linecap","round"),c(n,"stroke-linejoin","round"),c(l,"class","w-4 h-4 stroke-accent"),c(l,"viewBox","10 10 20 20"),c(l,"fill","none"),c(l,"xmlns","http://www.w3.org/2000/svg"),c(e,"class","pt-0.5 hidden"),c(b,"class","arrow-up"),c(D,"class","bg-accent p-2 flex flex-col flex-wrap gap-y-2 w-full overflow-y-scroll"),c(w,"class","comment-view hidden z-30 absolute text-primary w-full max-h-42"),c(w,"id",p="comments-"+a[64].id),c(h,"class","relative mb-1 w-full"),c(t,"class","flex flex-row gap-x-2")},m(V,q){L(V,t,q),d(t,e),d(e,l),d(l,r),d(l,s),d(l,n),d(t,o),d(t,h),C&&C.m(h,null),d(h,u),N&&N.m(h,null),d(h,$),d(h,w),d(w,b),d(w,E),d(w,D);for(let S=0;S<x.length;S+=1)x[S].m(D,null);d(t,y)},p(V,q){if(V[64].data.text?C?C.p(V,q):(C=It(V),C.c(),C.m(h,u)):C&&(C.d(1),C=null),V[64].data.file?N?N.p(V,q):(N=Tt(V),N.c(),N.m(h,$)):N&&(N.d(1),N=null),q[0]&1){j=V[0].annotations;let S;for(S=0;S<j.length;S+=1){const Q=$t(V,j,S);x[S]?x[S].p(Q,q):(x[S]=Ct(Q),x[S].c(),x[S].m(D,null))}for(;S<x.length;S+=1)x[S].d(1);x.length=j.length}q[0]&1&&p!==(p="comments-"+V[64].id)&&c(w,"id",p)},d(V){V&&i(t),C&&C.d(),N&&N.d(),Rt(x,V)}}}function Mt(a){let t,e,l,r,s;return e=new F({props:{src:"/icons/Comment Button - White on Black.svg",alt:"show comments"}}),{c(){t=g("button"),P(e.$$.fragment)},l(n){t=v(n,"BUTTON",{});var o=_(t);H(e.$$.fragment,o),o.forEach(i)},m(n,o){L(n,t,o),W(e,t,null),l=!0,r||(s=ee(t,"click",a[34]),r=!0)},p:_e,i(n){l||(B(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){n&&i(t),z(e),r=!1,s()}}}function Pt(a){let t,e,l,r,s,n,o,h;return s=new F({props:{src:"/icons/Comments - Close Icon.svg",alt:"comment - close"}}),{c(){t=g("button"),e=he("Leave a Note"),l=O(),r=g("button"),P(s.$$.fragment),this.h()},l(u){t=v(u,"BUTTON",{class:!0});var $=_(t);e=me($,"Leave a Note"),$.forEach(i),l=A(u),r=v(u,"BUTTON",{});var w=_(r);H(s.$$.fragment,w),w.forEach(i),this.h()},h(){c(t,"class","px-3 py-2 bg-black text-white")},m(u,$){L(u,t,$),d(t,e),L(u,l,$),L(u,r,$),W(s,r,null),n=!0,o||(h=[ee(t,"click",a[32]),ee(r,"click",a[33])],o=!0)},p:_e,i(u){n||(B(s.$$.fragment,u),n=!0)},o(u){R(s.$$.fragment,u),n=!1},d(u){u&&i(t),u&&i(l),u&&i(r),z(s),o=!1,Ke(h)}}}function Ht(a){let t,e,l,r,s,n,o,h,u,$,w;return e=new F({props:{src:"/icons/Comment - Draw Icon.svg",alt:"comment - draw"}}),s=new F({props:{src:"/icons/Comment - Highlight Icon.svg",alt:"comment - highlight"}}),h=new F({props:{src:"/icons/Comments - Close Icon.svg",alt:"comment - close"}}),{c(){t=g("button"),P(e.$$.fragment),l=O(),r=g("button"),P(s.$$.fragment),n=O(),o=g("button"),P(h.$$.fragment)},l(b){t=v(b,"BUTTON",{});var E=_(t);H(e.$$.fragment,E),E.forEach(i),l=A(b),r=v(b,"BUTTON",{});var D=_(r);H(s.$$.fragment,D),D.forEach(i),n=A(b),o=v(b,"BUTTON",{});var p=_(o);H(h.$$.fragment,p),p.forEach(i)},m(b,E){L(b,t,E),W(e,t,null),L(b,l,E),L(b,r,E),W(s,r,null),L(b,n,E),L(b,o,E),W(h,o,null),u=!0,$||(w=[ee(t,"click",a[29]),ee(r,"click",a[30]),ee(o,"click",a[31])],$=!0)},p:_e,i(b){u||(B(e.$$.fragment,b),B(s.$$.fragment,b),B(h.$$.fragment,b),u=!0)},o(b){R(e.$$.fragment,b),R(s.$$.fragment,b),R(h.$$.fragment,b),u=!1},d(b){b&&i(t),z(e),b&&i(l),b&&i(r),z(s),b&&i(n),b&&i(o),z(h),$=!1,Ke(w)}}}function Wt(a){let t,e,l,r,s,n,o,h,u,$,w,b,E,D;return e=new F({props:{src:"/icons/Comment - Draw Icon.svg",alt:"comment - draw"}}),s=new F({props:{src:"/icons/Comment - Delete Icon.svg",alt:"comment - delete"}}),h=new F({props:{src:"/icons/Comment - Save Icon.svg",alt:"comment - save"}}),w=new F({props:{src:"/icons/Comments - Close Icon.svg",alt:"comment - close"}}),{c(){t=g("button"),P(e.$$.fragment),l=O(),r=g("button"),P(s.$$.fragment),n=O(),o=g("button"),P(h.$$.fragment),u=O(),$=g("button"),P(w.$$.fragment)},l(p){t=v(p,"BUTTON",{});var y=_(t);H(e.$$.fragment,y),y.forEach(i),l=A(p),r=v(p,"BUTTON",{});var C=_(r);H(s.$$.fragment,C),C.forEach(i),n=A(p),o=v(p,"BUTTON",{});var N=_(o);H(h.$$.fragment,N),N.forEach(i),u=A(p),$=v(p,"BUTTON",{});var j=_($);H(w.$$.fragment,j),j.forEach(i)},m(p,y){L(p,t,y),W(e,t,null),L(p,l,y),L(p,r,y),W(s,r,null),L(p,n,y),L(p,o,y),W(h,o,null),L(p,u,y),L(p,$,y),W(w,$,null),b=!0,E||(D=[ee(t,"click",a[27]),ee(r,"click",a[18]),ee(o,"click",a[20]),ee($,"click",a[28])],E=!0)},p:_e,i(p){b||(B(e.$$.fragment,p),B(s.$$.fragment,p),B(h.$$.fragment,p),B(w.$$.fragment,p),b=!0)},o(p){R(e.$$.fragment,p),R(s.$$.fragment,p),R(h.$$.fragment,p),R(w.$$.fragment,p),b=!1},d(p){p&&i(t),z(e),p&&i(l),p&&i(r),z(s),p&&i(n),p&&i(o),z(h),p&&i(u),p&&i($),z(w),E=!1,Ke(D)}}}function zt(a){let t,e,l,r,s,n,o,h;return e=new F({props:{src:"/icons/Comment - Highlight Icon.svg",alt:"comment - highlight"}}),s=new F({props:{src:"/icons/Comments - Close Icon.svg",alt:"comment - close"}}),{c(){t=g("button"),P(e.$$.fragment),l=O(),r=g("button"),P(s.$$.fragment)},l(u){t=v(u,"BUTTON",{});var $=_(t);H(e.$$.fragment,$),$.forEach(i),l=A(u),r=v(u,"BUTTON",{});var w=_(r);H(s.$$.fragment,w),w.forEach(i)},m(u,$){L(u,t,$),W(e,t,null),L(u,l,$),L(u,r,$),W(s,r,null),n=!0,o||(h=ee(r,"click",a[26]),o=!0)},p:_e,i(u){n||(B(e.$$.fragment,u),B(s.$$.fragment,u),n=!0)},o(u){R(e.$$.fragment,u),R(s.$$.fragment,u),n=!1},d(u){u&&i(t),z(e),u&&i(l),u&&i(r),z(s),o=!1,h()}}}function Nt(a){let t,e,l,r=a[0].author_name+"",s,n,o,h=a[0].location+"",u,$,w,b=a[0].description+"",E;return{c(){t=g("div"),e=g("div"),l=g("div"),s=he(r),n=O(),o=g("div"),u=he(h),$=O(),w=g("div"),E=he(b),this.h()},l(D){t=v(D,"DIV",{class:!0});var p=_(t);e=v(p,"DIV",{class:!0});var y=_(e);l=v(y,"DIV",{class:!0});var C=_(l);s=me(C,r),C.forEach(i),n=A(y),o=v(y,"DIV",{class:!0});var N=_(o);u=me(N,h),N.forEach(i),$=A(y),w=v(y,"DIV",{class:!0});var j=_(w);E=me(j,b),j.forEach(i),y.forEach(i),p.forEach(i),this.h()},h(){c(l,"class","border border-primary text-left p-1 "),c(o,"class","border border-primary text-left p-1"),c(w,"class","border border-primary text-left p-1 text-sm"),c(e,"class","flex flex-col gap-y-3"),c(t,"class","absolute inset-x-0 bottom-8 bg-accent text-primary text-base p-4")},m(D,p){L(D,t,p),d(t,e),d(e,l),d(l,s),d(e,n),d(e,o),d(o,u),d(e,$),d(e,w),d(w,E)},p(D,p){p[0]&1&&r!==(r=D[0].author_name+"")&&Be(s,r),p[0]&1&&h!==(h=D[0].location+"")&&Be(u,h),p[0]&1&&b!==(b=D[0].description+"")&&Be(E,b)},d(D){D&&i(t)}}}function Vt(a){let t,e,l,r,s,n,o,h,u,$,w,b,E,D,p,y,C,N,j,x,V,q,S,Q,G,ie,ue,J;return u=new F({props:{src:"/icons/Share - WhatsApp Icon.svg",alt:"share - whatsapp"}}),E=new F({props:{src:"/icons/Share - Instagram Icon.svg",alt:"share - instagram"}}),y=new F({props:{src:"/icons/Share - Email Icon.svg",alt:"share - email"}}),x=new F({props:{src:"/icons/Share - Message Icon.svg",alt:"share - message"}}),Q=new F({props:{src:"/icons/Share - URL Icon.svg",alt:"share - url"}}),{c(){t=g("div"),e=g("div"),l=g("div"),r=he("Send Story"),s=O(),n=g("div"),o=g("div"),h=g("a"),P(u.$$.fragment),w=O(),b=g("button"),P(E.$$.fragment),D=O(),p=g("a"),P(y.$$.fragment),N=O(),j=g("a"),P(x.$$.fragment),q=O(),S=g("a"),P(Q.$$.fragment),this.h()},l(X){t=v(X,"DIV",{class:!0});var te=_(t);e=v(te,"DIV",{class:!0});var ne=_(e);l=v(ne,"DIV",{class:!0});var Ee=_(l);r=me(Ee,"Send Story"),Ee.forEach(i),s=A(ne),n=v(ne,"DIV",{class:!0});var de=_(n);o=v(de,"DIV",{class:!0});var Y=_(o);h=v(Y,"A",{href:!0,"data-action":!0});var le=_(h);H(u.$$.fragment,le),le.forEach(i),w=A(Y),b=v(Y,"BUTTON",{});var ge=_(b);H(E.$$.fragment,ge),ge.forEach(i),D=A(Y),p=v(Y,"A",{href:!0});var ve=_(p);H(y.$$.fragment,ve),ve.forEach(i),N=A(Y),j=v(Y,"A",{href:!0});var Z=_(j);H(x.$$.fragment,Z),Z.forEach(i),q=A(Y),S=v(Y,"A",{href:!0});var M=_(S);H(Q.$$.fragment,M),M.forEach(i),Y.forEach(i),de.forEach(i),ne.forEach(i),te.forEach(i),this.h()},h(){c(l,"class","border border-primary text-left p-1 "),c(h,"href",$="whatsapp://send?text="+a[13]),c(h,"data-action","share/whatsapp/share"),c(p,"href",C="mailto:?subject=Read this story on The Reading Room&body="+a[14]),c(j,"href",V="sms:?body="+a[14]),c(S,"href",G=window.location.href),c(o,"class","flex flex-row flex-nowrap justify-between"),c(n,"class","p-1"),c(e,"class","flex flex-col gap-y-3"),c(t,"class","absolute inset-x-0 bottom-8 bg-accent text-primary text-base p-4")},m(X,te){L(X,t,te),d(t,e),d(e,l),d(l,r),d(e,s),d(e,n),d(n,o),d(o,h),W(u,h,null),d(o,w),d(o,b),W(E,b,null),d(o,D),d(o,p),W(y,p,null),d(o,N),d(o,j),W(x,j,null),d(o,q),d(o,S),W(Q,S,null),ie=!0,ue||(J=[ee(b,"click",a[15]),ee(S,"click",a[16])],ue=!0)},p:_e,i(X){ie||(B(u.$$.fragment,X),B(E.$$.fragment,X),B(y.$$.fragment,X),B(x.$$.fragment,X),B(Q.$$.fragment,X),ie=!0)},o(X){R(u.$$.fragment,X),R(E.$$.fragment,X),R(y.$$.fragment,X),R(x.$$.fragment,X),R(Q.$$.fragment,X),ie=!1},d(X){X&&i(t),z(u),z(E),z(y),z(x),z(Q),ue=!1,Ke(J)}}}function Ft(a){let t,e,l;return e=new F({props:{src:"/icons/Back Button - Black.svg",alt:"back icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(r){t=v(r,"DIV",{class:!0});var s=_(t);H(e.$$.fragment,s),s.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(r,s){L(r,t,s),W(e,t,null),l=!0},i(r){l||(B(e.$$.fragment,r),l=!0)},o(r){R(e.$$.fragment,r),l=!1},d(r){r&&i(t),z(e)}}}function Gt(a){let t,e,l;return e=new F({props:{src:"/icons/Back Button - White.svg",alt:"back icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(r){t=v(r,"DIV",{class:!0});var s=_(t);H(e.$$.fragment,s),s.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(r,s){L(r,t,s),W(e,t,null),l=!0},i(r){l||(B(e.$$.fragment,r),l=!0)},o(r){R(e.$$.fragment,r),l=!1},d(r){r&&i(t),z(e)}}}function Jt(a){let t,e,l,r,s;return e=new F({props:{src:"/icons/Info Button - Black.svg",alt:"info icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(n){t=v(n,"DIV",{class:!0});var o=_(t);H(e.$$.fragment,o),o.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(n,o){L(n,t,o),W(e,t,null),l=!0,r||(s=ee(t,"click",a[37]),r=!0)},p:_e,i(n){l||(B(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){n&&i(t),z(e),r=!1,s()}}}function Qt(a){let t,e,l,r,s;return e=new F({props:{src:"/icons/Info Button - White.svg",alt:"info icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(n){t=v(n,"DIV",{class:!0});var o=_(t);H(e.$$.fragment,o),o.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(n,o){L(n,t,o),W(e,t,null),l=!0,r||(s=ee(t,"click",a[36]),r=!0)},p:_e,i(n){l||(B(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){n&&i(t),z(e),r=!1,s()}}}function Zt(a){let t,e,l,r,s;return e=new F({props:{src:"/icons/Share Button - Black.svg",alt:"share icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(n){t=v(n,"DIV",{class:!0});var o=_(t);H(e.$$.fragment,o),o.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(n,o){L(n,t,o),W(e,t,null),l=!0,r||(s=ee(t,"click",a[39]),r=!0)},p:_e,i(n){l||(B(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){n&&i(t),z(e),r=!1,s()}}}function Kt(a){let t,e,l,r,s;return e=new F({props:{src:"/icons/Share Button - White.svg",alt:"share icon"}}),{c(){t=g("div"),P(e.$$.fragment),this.h()},l(n){t=v(n,"DIV",{class:!0});var o=_(t);H(e.$$.fragment,o),o.forEach(i),this.h()},h(){c(t,"class","w-6 h-6")},m(n,o){L(n,t,o),W(e,t,null),l=!0,r||(s=ee(t,"click",a[38]),r=!0)},p:_e,i(n){l||(B(e.$$.fragment,n),l=!0)},o(n){R(e.$$.fragment,n),l=!1},d(n){n&&i(t),z(e),r=!1,s()}}}function Lt(a){let t,e,l,r,s,n,o,h,u,$,w,b,E,D;return w=new F({props:{src:"/icons/Highlight - Send Icon.svg",alt:"send icon"}}),{c(){t=g("section"),e=g("span"),l=g("section"),r=O(),s=g("main"),n=g("section"),o=g("textarea"),h=O(),u=g("section"),$=g("button"),P(w.$$.fragment),this.h()},l(p){t=v(p,"SECTION",{class:!0});var y=_(t);e=v(y,"SPAN",{id:!0,class:!0});var C=_(e);l=v(C,"SECTION",{class:!0}),_(l).forEach(i),r=A(C),s=v(C,"MAIN",{class:!0});var N=_(s);n=v(N,"SECTION",{});var j=_(n);o=v(j,"TEXTAREA",{class:!0,name:!0,id:!0,placeholder:!0,rows:!0,cols:!0,wrap:!0}),_(o).forEach(i),j.forEach(i),h=A(N),u=v(N,"SECTION",{class:!0});var x=_(u);$=v(x,"BUTTON",{});var V=_($);H(w.$$.fragment,V),V.forEach(i),x.forEach(i),N.forEach(i),C.forEach(i),y.forEach(i),this.h()},h(){c(l,"class","arrow-up"),c(o,"class","bg-accent text-primary placeholder:text-primary focus:outline-none overflow-hidden w-full"),c(o,"name","annotation"),c(o,"id","annotation"),c(o,"placeholder","Leave a comment"),c(o,"rows","2"),c(o,"cols","30"),c(o,"wrap","soft"),c(u,"class","flex flex-row-reverse items-center"),c(s,"class","flex flex-col p-2 w-10/12 text-primary bg-accent underline"),c(e,"id","selection-controls"),c(e,"class","select-none"),c(t,"class","hidden")},m(p,y){L(p,t,y),d(t,e),d(e,l),d(e,r),d(e,s),d(s,n),d(n,o),Et(o,a[11]),d(s,h),d(s,u),d(u,$),W(w,$,null),a[41](e),b=!0,E||(D=[ee(o,"input",a[40]),ee($,"click",a[22])],E=!0)},p(p,y){y[0]&2048&&Et(o,p[11])},i(p){b||(B(w.$$.fragment,p),b=!0)},o(p){R(w.$$.fragment,p),b=!1},d(p){p&&i(t),z(w),a[41](null),E=!1,Ke(D)}}}function en(a){let t,e,l,r=a[0].title+"",s,n,o,h,u,$,w,b,E,D,p,y,C,N,j,x,V,q,S,Q,G,ie,ue,J,X,te,ne,Ee,de,Y,le,ge,ve,Z,M,ce,Ae,$e,se,Ie,We,ze,Te,ye,et,Fe,De,xe=a[0].title+"",Re,Ge,Ce,Oe=a[0].description+"",Ue,be,Se=a[0].submission.blocks,oe=[];for(let k=0;k<Se.length;k+=1)oe[k]=St(yt(a,Se,k));const tt=[zt,Wt,Ht,Pt,Mt],ke=[];function nt(k,U){return k[7]?0:k[5]?1:k[10]?2:k[4]?3:4}q=nt(a),S=ke[q]=tt[q](a);let f=a[8]&&Nt(a),m=a[9]&&Vt(a);const T=[Gt,Ft],I=[];function fe(k,U){return k[8]||k[9]?0:1}te=fe(a),ne=I[te]=T[te](a);const re=[Qt,Jt],Ne=[];function st(k,U){return k[8]||k[9]?0:1}Y=st(a),le=Ne[Y]=re[Y](a);const at=[Kt,Zt],Ve=[];function it(k,U){return k[8]||k[9]?0:1}Z=it(a),M=Ve[Z]=at[Z](a);let K=a[7]&&Lt(a);return{c(){t=g("div"),e=g("div"),l=g("div"),s=he(r),n=O(),o=g("div"),h=g("div");for(let k=0;k<oe.length;k+=1)oe[k].c();$=O(),w=g("section"),b=g("div"),E=g("canvas"),D=he("your browser does not support the canvas"),p=O(),y=g("div"),C=g("canvas"),N=he("your browser does not support the canvas"),j=O(),x=g("div"),V=g("div"),S.c(),Q=O(),G=g("section"),f&&f.c(),ie=O(),m&&m.c(),ue=O(),J=g("div"),X=g("a"),ne.c(),Ee=O(),de=g("div"),le.c(),ge=O(),ve=g("div"),M.c(),Ae=O(),K&&K.c(),$e=O(),se=g("div"),Ie=g("h1"),We=he("The Reading Room"),ze=O(),Te=g("div"),ye=g("img"),Fe=O(),De=g("h2"),Re=he(xe),Ge=O(),Ce=g("p"),Ue=he(Oe),this.h()},l(k){t=v(k,"DIV",{class:!0});var U=_(t);e=v(U,"DIV",{class:!0});var pe=_(e);l=v(pe,"DIV",{class:!0});var qe=_(l);s=me(qe,r),qe.forEach(i),n=A(pe),o=v(pe,"DIV",{class:!0});var we=_(o);h=v(we,"DIV",{id:!0,class:!0});var Xe=_(h);for(let rt=0;rt<oe.length;rt+=1)oe[rt].l(Xe);Xe.forEach(i),$=A(we),w=v(we,"SECTION",{id:!0,class:!0});var ae=_(w);b=v(ae,"DIV",{id:!0,class:!0});var Je=_(b);E=v(Je,"CANVAS",{});var ct=_(E);D=me(ct,"your browser does not support the canvas"),ct.forEach(i),Je.forEach(i),p=A(ae),y=v(ae,"DIV",{class:!0});var ft=_(y);C=v(ft,"CANVAS",{});var ut=_(C);N=me(ut,"your browser does not support the canvas"),ut.forEach(i),ft.forEach(i),ae.forEach(i),j=A(we),x=v(we,"DIV",{class:!0});var dt=_(x);V=v(dt,"DIV",{class:!0});var ht=_(V);S.l(ht),ht.forEach(i),dt.forEach(i),we.forEach(i),pe.forEach(i),Q=A(U),G=v(U,"SECTION",{});var je=_(G);f&&f.l(je),ie=A(je),m&&m.l(je),ue=A(je),J=v(je,"DIV",{class:!0,style:!0});var Ye=_(J);X=v(Ye,"A",{href:!0});var mt=_(X);ne.l(mt),mt.forEach(i),Ee=A(Ye),de=v(Ye,"DIV",{});var pt=_(de);le.l(pt),pt.forEach(i),ge=A(Ye),ve=v(Ye,"DIV",{});var _t=_(ve);M.l(_t),_t.forEach(i),Ye.forEach(i),je.forEach(i),U.forEach(i),Ae=A(k),K&&K.l(k),$e=A(k),se=v(k,"DIV",{id:!0,class:!0});var Le=_(se);Ie=v(Le,"H1",{class:!0});var gt=_(Ie);We=me(gt,"The Reading Room"),gt.forEach(i),ze=A(Le),Te=v(Le,"DIV",{class:!0});var vt=_(Te);ye=v(vt,"IMG",{class:!0,src:!0,alt:!0}),vt.forEach(i),Fe=A(Le),De=v(Le,"H2",{class:!0});var bt=_(De);Re=me(bt,xe),bt.forEach(i),Ge=A(Le),Ce=v(Le,"P",{class:!0});var kt=_(Ce);Ue=me(kt,Oe),kt.forEach(i),Le.forEach(i),this.h()},h(){c(l,"class","px-1 text-base border"),c(h,"id","reader"),c(h,"class",u=a[4]==!0?"flex flex-col p-2 z-10":"flex flex-col p-2"),c(b,"id","current-cnv"),c(b,"class","absolute left-0 top-0"),c(y,"class","absolute left-0 top-0"),c(w,"id","drawing-board"),c(w,"class","absolute left-0 top-0"),c(V,"class","flex flex-row"),c(x,"class","mt-auto ml-auto"),c(o,"class","relative flex-1 text-sm border flex flex-col select-text"),c(e,"class","overflow-y-scroll flex-1 flex flex-col align-items-center gap-y-2 font-display text-left mx-4"),c(X,"href","/stories"),c(J,"class",ce=a[8]||a[9]?"flex-initial flex flex-row justify-between py-2 px-5 bg-accent text-primary":"flex-initial flex flex-row justify-between py-2 px-5 bg-primary"),Ut(J,"border-top","black 1.5px solid"),c(t,"class","flex-1 flex flex-col align-items-center gap-y-4 w-screen overflow-y-scroll bg-primary text-center select-none"),c(Ie,"class","text-lg"),c(ye,"class","w-full h-full object-cover rounded-full border-2 border-accent"),Ze(ye.src,et="/img/Main Illustration - Green.png")||c(ye,"src",et),c(ye,"alt","home illustration"),c(Te,"class","h-52 w-52 pt-1 self-center"),c(De,"class","font-display font-semibold text-sm"),c(Ce,"class","font-text text-sm"),c(se,"id","capture"),c(se,"class","hidden absolute left-0 px-2 bg-primary w-full flex flex-col gap-y-1 items-center")},m(k,U){L(k,t,U),d(t,e),d(e,l),d(l,s),d(e,n),d(e,o),d(o,h);for(let pe=0;pe<oe.length;pe+=1)oe[pe].m(h,null);a[23](h),d(o,$),d(o,w),d(w,b),d(b,E),d(E,D),a[24](E),d(w,p),d(w,y),d(y,C),d(C,N),a[25](C),d(o,j),d(o,x),d(x,V),ke[q].m(V,null),a[35](e),d(t,Q),d(t,G),f&&f.m(G,null),d(G,ie),m&&m.m(G,null),d(G,ue),d(G,J),d(J,X),I[te].m(X,null),d(J,Ee),d(J,de),Ne[Y].m(de,null),d(J,ge),d(J,ve),Ve[Z].m(ve,null),L(k,Ae,U),K&&K.m(k,U),L(k,$e,U),L(k,se,U),d(se,Ie),d(Ie,We),d(se,ze),d(se,Te),d(Te,ye),d(se,Fe),d(se,De),d(De,Re),d(se,Ge),d(se,Ce),d(Ce,Ue),be=!0},p(k,U){if((!be||U[0]&1)&&r!==(r=k[0].title+"")&&Be(s,r),U[0]&2097153){Se=k[0].submission.blocks;let ae;for(ae=0;ae<Se.length;ae+=1){const Je=yt(k,Se,ae);oe[ae]?oe[ae].p(Je,U):(oe[ae]=St(Je),oe[ae].c(),oe[ae].m(h,null))}for(;ae<oe.length;ae+=1)oe[ae].d(1);oe.length=Se.length}(!be||U[0]&16&&u!==(u=k[4]==!0?"flex flex-col p-2 z-10":"flex flex-col p-2"))&&c(h,"class",u);let pe=q;q=nt(k),q===pe?ke[q].p(k,U):(Pe(),R(ke[pe],1,1,()=>{ke[pe]=null}),Me(),S=ke[q],S?S.p(k,U):(S=ke[q]=tt[q](k),S.c()),B(S,1),S.m(V,null)),k[8]?f?f.p(k,U):(f=Nt(k),f.c(),f.m(G,ie)):f&&(f.d(1),f=null),k[9]?m?(m.p(k,U),U[0]&512&&B(m,1)):(m=Vt(k),m.c(),B(m,1),m.m(G,ue)):m&&(Pe(),R(m,1,1,()=>{m=null}),Me());let qe=te;te=fe(k),te!==qe&&(Pe(),R(I[qe],1,1,()=>{I[qe]=null}),Me(),ne=I[te],ne||(ne=I[te]=T[te](k),ne.c()),B(ne,1),ne.m(X,null));let we=Y;Y=st(k),Y===we?Ne[Y].p(k,U):(Pe(),R(Ne[we],1,1,()=>{Ne[we]=null}),Me(),le=Ne[Y],le?le.p(k,U):(le=Ne[Y]=re[Y](k),le.c()),B(le,1),le.m(de,null));let Xe=Z;Z=it(k),Z===Xe?Ve[Z].p(k,U):(Pe(),R(Ve[Xe],1,1,()=>{Ve[Xe]=null}),Me(),M=Ve[Z],M?M.p(k,U):(M=Ve[Z]=at[Z](k),M.c()),B(M,1),M.m(ve,null)),(!be||U[0]&768&&ce!==(ce=k[8]||k[9]?"flex-initial flex flex-row justify-between py-2 px-5 bg-accent text-primary":"flex-initial flex flex-row justify-between py-2 px-5 bg-primary"))&&c(J,"class",ce),k[7]?K?(K.p(k,U),U[0]&128&&B(K,1)):(K=Lt(k),K.c(),B(K,1),K.m($e.parentNode,$e)):K&&(Pe(),R(K,1,1,()=>{K=null}),Me()),(!be||U[0]&1)&&xe!==(xe=k[0].title+"")&&Be(Re,xe),(!be||U[0]&1)&&Oe!==(Oe=k[0].description+"")&&Be(Ue,Oe)},i(k){be||(B(S),B(m),B(ne),B(le),B(M),B(K),be=!0)},o(k){R(S),R(m),R(ne),R(le),R(M),R(K),be=!1},d(k){k&&i(t),Rt(oe,k),a[23](null),a[24](null),a[25](null),ke[q].d(),a[35](null),f&&f.d(),m&&m.d(),I[te].d(),Ne[Y].d(),Ve[Z].d(),k&&i(Ae),K&&K.d(k),k&&i($e),k&&i(se)}}}const rn=async({params:a,fetch:t,session:e,stuff:l})=>{const{slug:r}=a,s=await t("/storiesapi");if(s.status===404){const n=new Error(`The post with ID ${r} was not found`);return{status:404,error:n}}else{let n=await s.json();return n=n.find(o=>o.url===r),{props:{story:n}}}};function Bt(a){return{identifier:a.identifier,clientX:a.clientX,clientY:a.clientY}}function tn(a,t,e){let{story:l}=t,r,s,n,o,h=!1,u,$,w,b=[],E=!1,D=!1,p=!1,y=!1,C=!1,N=!1,j=`
  The Reading Room is a collaborative storytelling project that enables us to think of place differently. Through storytelling, we can take the initiative of re-defining a place beyond its history and geography.%0a
  *${l.title}*%0a
  _${l.description}_%0a
  Read it here ${He.site_url}/stories/${l.url}
  `,x=`
  The Reading Room is a collaborative storytelling project that enables us to think of place differently. Through storytelling, we can take the initiative of re-defining a place beyond its history and geography.%0D%0A
  ${l.title}%0D%0A
  ${l.description}%0D%0A
  Read it here ${He.site_url}/stories/${l.url}
  `;const V=()=>{document.querySelector("#capture").classList.remove("hidden"),Xt(document.querySelector("#capture")).then(f=>{document.querySelector("#capture").classList.add("hidden");var m=document.createElement("a");m.download="story.png",m.href=f.toDataURL(),m.click();let T=document.createElement("a");T.href="instagram://story-camera",T.click()})},q=()=>{navigator.clipboard.writeText(window.location.href),e(9,C=!1)},S=f=>{const m=document.querySelector(`section#target_${f.blockID}`);console.log(`section#target_${f.blockID}`),m.classList.add("highlight");const T=m.parentElement.previousElementSibling;T.classList.remove("hidden"),T.addEventListener("click",()=>{const I=document.querySelectorAll(".comment-view");Array.from(I).forEach(re=>{re.id!=`comments-${f.blockID}`&&re.classList.add("hidden")}),document.querySelector(`section#target_${f.blockID}`).getBoundingClientRect(),document.querySelector(`section#comments-${f.blockID}`).classList.toggle("hidden")})},Q=f=>{const m=document.querySelector(`section#target_${f.blockID}`);m.innerHTML=m.dataset.content,m.classList.remove("highlight"),m.parentElement.previousElementSibling.classList.add("hidden")},G=f=>{!h||(console.log("info: drawing"),o.lineWidth=4,o.lineCap="round",o.strokeStyle="#6A735A",console.log(f.clientX+s.offsetLeft,f.clientY+s.parentNode.offsetTop),console.log(f.clientX,f.clientY),o.lineTo(f.clientX-s.offsetLeft,f.clientY-s.parentNode.offsetTop-r.parentNode.offsetTop),o.stroke())},ie=f=>{console.log("info: beginning draw"),h=!0},ue=f=>{h=!1,o.stroke(),o.beginPath()};function J(f){for(var m=0;m<b.length;m++){var T=b[m].identifier;if(T==f)return m}return-1}function X(f){var m=0,T=0;if(f.offsetParent){do m+=f.offsetLeft,T+=f.offsetTop;while(f=f.offsetParent);return{x:m-r.parentNode.parentNode.scrollLeft,y:T-r.parentNode.parentNode.scrollTop}}}function te(f){f.preventDefault(),console.log("touchstart.");for(var m=f.changedTouches,T=X(n),I=0;I<m.length;I++)m[I].clientX-T.x>0&&m[I].clientX-T.x<parseFloat(n.width)&&m[I].clientY-T.y>0&&m[I].clientY-T.y<parseFloat(n.height)&&(f.preventDefault(),console.log("touchstart:"+I+"..."),b.push(Bt(m[I])),console.log("touchstart:"+I+"."))}function ne(f){f.preventDefault();var m=f.changedTouches,T=X(n);console.log(T),console.log(b);for(var I=0;I<m.length;I++){var fe="#6A735A",re=J(m[I].identifier);re>=0?(console.log("continuing touch "+re),o.beginPath(),console.log("ctx.moveTo("+b[re].clientX+", "+b[re].clientY+");"),o.moveTo(b[re].clientX-T.x,b[re].clientY-T.y),console.log("ctx.lineTo("+m[I].clientX+", "+m[I].clientY+");"),o.lineTo(m[I].clientX-T.x,m[I].clientY-T.y),o.lineWidth=4,o.strokeStyle=fe,o.stroke(),b.splice(re,1,Bt(m[I])),console.log(".")):console.log("can't figure out which touch to continue")}}function Ee(f){f.preventDefault();for(var m=f.changedTouches,T=X(n),I=0;I<m.length;I++)if(m[I].clientX-T.x>0&&m[I].clientX-T.x<parseFloat(n.width)&&m[I].clientY-T.y>0&&m[I].clientY-T.y<parseFloat(n.height)){f.preventDefault();var fe=J(m[I].identifier);fe>=0?(o.fillStyle="transparent",o.beginPath(),o.moveTo(b[fe].clientX-T.x,b[fe].clientY-T.y),o.lineTo(m[I].clientX-T.x,m[I].clientY-T.y),o.fillRect(m[I].clientX-4-T.x,m[I].clientY-4-T.y,8,8),b.splice(I,1)):console.log("can't figure out which touch to end")}}const de=()=>{console.log("info: canvas init"),Y(),n.addEventListener("touchstart",te),n.addEventListener("touchend",Ee),n.addEventListener("touchmove",ne)},Y=()=>{fetch(`${He.strapi_url}/api/stories/${l.id}?populate=annotationCanvas`).then(f=>f.json()).then(f=>{var T,I;if(console.log(f.data.attributes),f.data.attributes.annotationCanvas.data==null)return;let m=f.data.attributes.annotationCanvas.data.attributes.formats;m=(I=(T=m.thumbnail.url)!=null?T:m.small.url)!=null?I:m.medium.url,fetch(m).then(fe=>fe.blob()).then(fe=>{let re=new Image;re.src=URL.createObjectURL(fe),re.onload=()=>{console.log("info: prev canvas loaded"),w=re,$.drawImage(re,0,0,n.width,n.height)}})})},le=()=>{o.clearRect(0,0,n.width,n.height)},ge=()=>{n.removeEventListener("pointerdown",ie),n.removeEventListener("pointerup",ue),n.removeEventListener("pointermove",G),n.removeEventListener("touchstart",te),n.removeEventListener("touchend",Ee),n.removeEventListener("touchmove",ne),document.querySelector("#current-cnv").classList.add("hidden")},ve=()=>{w!=null&&o.drawImage(w,0,0,n.width,n.height),n.toBlob(f=>{let m=new FormData;m.append("files",f,`${l.id}-canvas.png`),fetch(`${He.strapi_url}/api/upload`,{method:"POST",body:m}).then(T=>T.json()).then(T=>{e(4,E=!0),e(5,D=!1),ge(),Y();const I={data:{annotationCanvas:T[0].id}};return fetch(`${He.strapi_url}/api/stories/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})})}),ge()};let Z,M,ce,Ae=`${He.strapi_url}/api/annotations`;const $e=f=>{se(),console.log("info: showing controls"),console.log(f.target);let m=f.target,T=new Range;T.setStart(m,0),T.setEnd(m,m.childNodes.length),M=f.target;let I=f.target.innerText;if(I.length>0){let fe=f.target.getBoundingClientRect();e(12,ce.style.top=`calc(${fe.bottom}px + 0px)`,ce),e(12,ce.style.left="1.5rem",ce),e(12,ce.text=I,ce),document.body.appendChild(ce)}console.log("info: adding class"),f.target.classList.add("highlight")},se=f=>{console.log("info: removing controls"),[document.querySelector("#selection-controls")].forEach(T=>{T!==null&&(console.log("removing.."),T.remove(),document.getSelection().removeAllRanges())}),M!=null&&M.classList.remove("highlight"),M=null},Ie=()=>{console.log("info: posting annotation"),console.log(M.innerText);const f={data:{targetText:M.innerText,blockID:M.id.split("_")[1],length:M.innerText.length,content:Z,startOffset:0,story:l.id}};console.log(f),se(),fetch(Ae,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}).then(m=>{M!=null&&M.classList.remove("highlight"),M=null})};qt(()=>{const f=document.querySelector("#capture");f.style.top=`${document.body.offsetHeight}px`});function We(f){Qe[f?"unshift":"push"](()=>{r=f,e(1,r)})}function ze(f){Qe[f?"unshift":"push"](()=>{n=f,e(2,n),e(5,D),e(4,E),e(1,r),e(3,u)})}function Te(f){Qe[f?"unshift":"push"](()=>{u=f,e(3,u),e(5,D),e(4,E),e(1,r),e(2,n)})}const ye=()=>{e(7,p=!p),e(4,E=!0)},et=()=>{e(5,D=!0),de()},Fe=()=>{e(5,D=!D),e(4,E=!0),ge()},De=()=>{e(5,D=!0),e(4,E=!1),de()},xe=()=>{e(7,p=!0),e(4,E=!1),le()},Re=()=>{e(10,N=!N),e(4,E=!0)},Ge=()=>{e(10,N=!N)},Ce=()=>{e(4,E=!1)},Oe=()=>{e(4,E=!E)};function Ue(f){Qe[f?"unshift":"push"](()=>{s=f,e(6,s)})}const be=()=>{e(8,y=!y),e(9,C=!1)},Se=()=>{e(8,y=!y),e(9,C=!1)},oe=()=>{e(9,C=!C),e(8,y=!1)},tt=()=>{e(9,C=!C),e(8,y=!1)};function ke(){Z=this.value,e(11,Z)}function nt(f){Qe[f?"unshift":"push"](()=>{ce=f,e(12,ce)})}return a.$$set=f=>{"story"in f&&e(0,l=f.story)},a.$$.update=()=>{a.$$.dirty[0]&17&&(E===!0?(l.annotations.forEach(f=>S(f)),Y()):document.querySelector("#drawing-board")!=null&&(l.annotations.forEach(f=>Q(f)),console.log("adding"),console.log(document.querySelector("#drawing-board")),document.querySelector("#drawing-board").classList.add("hidden"),console.log(document.querySelector("#drawing-board")))),a.$$.dirty[0]&62&&(D==!0||E==!0)&&(e(2,n=document.querySelector("canvas")),e(2,n.height=r.offsetHeight,n),e(2,n.width=r.offsetWidth,n),o=n.getContext("2d"),e(3,u.height=r.offsetHeight,u),e(3,u.width=r.offsetWidth,u),$=u.getContext("2d"),console.log("removign hidden"),document.querySelector("#drawing-board").classList.remove("hidden"),D==!0&&E==!1?n.parentNode.classList.add("z-20"):n.parentNode.classList.remove("z-20"))},[l,r,n,u,E,D,s,p,y,C,N,Z,ce,j,x,V,q,de,le,ge,ve,$e,Ie,We,ze,Te,ye,et,Fe,De,xe,Re,Ge,Ce,Oe,Ue,be,Se,oe,tt,ke,nt]}class sn extends xt{constructor(t){super();Ot(this,t,tn,en,At,{story:0},null,[-1,-1,-1])}}export{sn as default,rn as load};
