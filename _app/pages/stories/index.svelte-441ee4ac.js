import{W as be,D as ge,S as Ee,i as De,s as Ie,e as b,k as O,O as A,c as g,a as d,m as U,P as z,d as h,b as r,g as F,H as c,T as W,Q,t as H,h as R,j as G,U as we,R as ye,M as X,L as ie,N as Le,l as ne}from"../../chunks/vendor-64152532.js";import{v as ce}from"../../chunks/visited-f5fabbb6.js";import{v as ke}from"../../chunks/variables-0cfc34e1.js";const Ve=s=>{s=s.replace(/^\s+|\s+$/g,""),s=s.toLowerCase();const l="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",t="aaaaeeeeiiiioooouuuunc------";for(let e=0,n=l.length;e<n;e++)s=s.replace(new RegExp(l.charAt(e),"g"),t.charAt(e));return s=s.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),s};let J=!1,K=!1,Y=[],ue=1;const fe=ge({loading:J,data:Y,noMoreData:K});var he={subscribe:fe.subscribe,async fetchNextPage(){if(J||K)return;const s=be.stringify({populate:["author","categories"],pagination:{page:ue,pageSize:10}},{encodeValuesOnly:!0});J=!0;const l=await fetch(`${ke.strapi_url}/api/stories?${s}`);J=!1;let t=(await l.json()).data;K=t.length===0,t=t.map(e=>{const n=e.attributes.author.data.attributes.username,f=/([A-Za-z\s]+,*)/g;let i=e.attributes.location.trim();const p=i.match(f);if(p!=null){const u=p.length;u===1?i=`${p[0]}`:i=`${p[u-2]} ${p[u-1]}`}return{id:e.id,title:e.attributes.title,location:i,description:e.attributes.description,author_name:n,url:Ve(n+"-"+e.attributes.title),categories:e.attributes.categories.data.map(u=>u.attributes.name)}}),Y.push(...t),ue+=1,fe.set({loading:J,data:Y,noMoreData:K})}};const xe=ge([]);async function Te(){const s=be.stringify({pagination:{page:1,pageSize:6}},{encodeValuesOnly:!0});let t=(await(await fetch(`${ke.strapi_url}/api/categories?${s}`)).json()).data;t=t.map(e=>({name:e.attributes.name})),xe.set(t)}Te();function pe(s,l,t){const e=s.slice();return e[19]=l[t],e}function de(s,l,t){const e=s.slice();return e[22]=l[t],e}function Ne(s){let l,t;return{c(){l=b("video"),this.h()},l(e){l=g(e,"VIDEO",{src:!0}),d(l).forEach(h),this.h()},h(){Le(l.src,t="/img/loading.webm")||r(l,"src",t),l.autoplay=!0,l.loop=!0,l.muted=!0},m(e,n){F(e,l,n)},p:X,d(e){e&&h(l)}}}function Be(s){let l,t;return{c(){l=b("p"),t=H("sorry, we could'nt find what you were looking for"),this.h()},l(e){l=g(e,"P",{class:!0});var n=d(l);t=R(n,"sorry, we could'nt find what you were looking for"),n.forEach(h),this.h()},h(){r(l,"class","font-display text-xs text-left")},m(e,n){F(e,l,n),c(l,t)},p:X,d(e){e&&h(l)}}}function Pe(s){let l,t=s[0],e=[];for(let n=0;n<t.length;n+=1)e[n]=_e(de(s,t,n));return{c(){for(let n=0;n<e.length;n+=1)e[n].c();l=ne()},l(n){for(let f=0;f<e.length;f+=1)e[f].l(n);l=ne()},m(n,f){for(let i=0;i<e.length;i+=1)e[i].m(n,f);F(n,l,f)},p(n,f){if(f&1057){t=n[0];let i;for(i=0;i<t.length;i+=1){const p=de(n,t,i);e[i]?e[i].p(p,f):(e[i]=_e(p),e[i].c(),e[i].m(l.parentNode,l))}for(;i<e.length;i+=1)e[i].d(1);e.length=t.length}},d(n){we(e,n),n&&h(l)}}}function _e(s){let l,t,e,n,f,i=s[22].title+"",p,u,v,w,x=s[22].author_name+"",E,L,y,D,I=s[22].location+"",B,T,P,C,k=s[22].description+"",o,a,_,m,q,j;function M(){return s[12](s[22])}return{c(){l=b("div"),t=b("a"),e=b("div"),n=b("div"),f=b("h1"),p=H(i),u=O(),v=b("div"),w=b("p"),E=H(x),L=O(),y=b("div"),D=b("p"),B=H(I),T=O(),P=b("div"),C=b("p"),o=H(k),m=O(),this.h()},l(N){l=g(N,"DIV",{});var V=d(l);t=g(V,"A",{href:!0});var Z=d(t);e=g(Z,"DIV",{class:!0});var S=d(e);n=g(S,"DIV",{class:!0});var $=d(n);f=g($,"H1",{});var ee=d(f);p=R(ee,i),ee.forEach(h),$.forEach(h),u=U(S),v=g(S,"DIV",{class:!0});var te=d(v);w=g(te,"P",{});var le=d(w);E=R(le,x),le.forEach(h),te.forEach(h),L=U(S),y=g(S,"DIV",{class:!0});var re=d(y);D=g(re,"P",{});var se=d(D);B=R(se,I),se.forEach(h),re.forEach(h),T=U(S),P=g(S,"DIV",{class:!0});var ae=d(P);C=g(ae,"P",{});var oe=d(C);o=R(oe,k),oe.forEach(h),ae.forEach(h),S.forEach(h),Z.forEach(h),m=U(V),V.forEach(h),this.h()},h(){r(n,"class","text-base font-display"),r(v,"class","text-sm"),r(y,"class","text-sm"),r(P,"class","text-sm"),r(e,"class",a="px-3 py-3 w-full border border-black border-1 text-center font-text inline-flex flex-col gap-y-1 "+(s[5].includes(s[22].id)==!0?"bg-story-accent text-primary":"bg-primary")),r(t,"href",_="/stories/"+s[22].url)},m(N,V){F(N,l,V),c(l,t),c(t,e),c(e,n),c(n,f),c(f,p),c(e,u),c(e,v),c(v,w),c(w,E),c(e,L),c(e,y),c(y,D),c(D,B),c(e,T),c(e,P),c(P,C),c(C,o),c(l,m),q||(j=Q(t,"click",M),q=!0)},p(N,V){s=N,V&1&&i!==(i=s[22].title+"")&&G(p,i),V&1&&x!==(x=s[22].author_name+"")&&G(E,x),V&1&&I!==(I=s[22].location+"")&&G(B,I),V&1&&k!==(k=s[22].description+"")&&G(o,k),V&33&&a!==(a="px-3 py-3 w-full border border-black border-1 text-center font-text inline-flex flex-col gap-y-1 "+(s[5].includes(s[22].id)==!0?"bg-story-accent text-primary":"bg-primary"))&&r(e,"class",a),V&1&&_!==(_="/stories/"+s[22].url)&&r(t,"href",_)},d(N){N&&h(l),q=!1,j()}}}function me(s){let l,t,e,n,f,i,p,u,v,w,x,E,L,y,D,I,B,T,P,C,k=s[6],o=[];for(let a=0;a<k.length;a+=1)o[a]=ve(pe(s,k,a));return{c(){l=b("div"),t=b("div"),e=b("input"),n=O(),f=b("button"),i=A("svg"),p=A("circle"),u=A("path"),v=O(),w=b("div"),x=b("input"),E=O(),L=b("button"),y=A("svg"),D=A("circle"),I=A("path"),B=O(),T=b("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){l=g(a,"DIV",{class:!0});var _=d(l);t=g(_,"DIV",{class:!0});var m=d(t);e=g(m,"INPUT",{type:!0,name:!0,placeholder:!0,class:!0}),n=U(m),f=g(m,"BUTTON",{class:!0});var q=d(f);i=z(q,"svg",{viewBox:!0,fill:!0,xmlns:!0});var j=d(i);p=z(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),d(p).forEach(h),u=z(j,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0}),d(u).forEach(h),j.forEach(h),q.forEach(h),m.forEach(h),v=U(_),w=g(_,"DIV",{class:!0});var M=d(w);x=g(M,"INPUT",{type:!0,name:!0,placeholder:!0,class:!0}),E=U(M),L=g(M,"BUTTON",{class:!0});var N=d(L);y=z(N,"svg",{viewBox:!0,fill:!0,xmlns:!0});var V=d(y);D=z(V,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),d(D).forEach(h),I=z(V,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0}),d(I).forEach(h),V.forEach(h),N.forEach(h),M.forEach(h),B=U(_),T=g(_,"DIV",{class:!0});var Z=d(T);for(let S=0;S<o.length;S+=1)o[S].l(Z);Z.forEach(h),_.forEach(h),this.h()},h(){r(e,"type","text"),r(e,"name","location-query"),r(e,"placeholder","Enter a location"),r(e,"class","flex-1 py-1 bg-accent text-sm px-2 text-primary placeholder:text-primary focus:outline-none"),r(p,"cx","19"),r(p,"cy","19"),r(p,"r","7"),r(p,"stroke","#EEE2D2"),r(p,"stroke-width","1.5"),r(u,"d","M28 28L25 25"),r(u,"stroke","#EEE2D2"),r(u,"stroke-width","1.5"),r(u,"stroke-linecap","round"),r(i,"viewBox","0 0 40 40"),r(i,"fill","none"),r(i,"xmlns","http://www.w3.org/2000/svg"),r(f,"class","w-8 h-8 text-primary focus:outline-none"),r(t,"class","flex flex-row justify-between divide-x divide-primary w-full border border-primary bg-accent gap-x-base"),r(x,"type","text"),r(x,"name","tag-query"),r(x,"placeholder","Enter a tag/topic"),r(x,"class","flex-1 py-1 bg-accent text-sm px-2 text-primary placeholder:text-primary focus:outline-none "),r(D,"cx","19"),r(D,"cy","19"),r(D,"r","7"),r(D,"stroke","#EEE2D2"),r(D,"stroke-width","1.5"),r(I,"d","M28 28L25 25"),r(I,"stroke","#EEE2D2"),r(I,"stroke-width","1.5"),r(I,"stroke-linecap","round"),r(y,"viewBox","0 0 40 40"),r(y,"fill","none"),r(y,"xmlns","http://www.w3.org/2000/svg"),r(L,"class","w-8 h-8 text-primary focus:outline-none"),r(w,"class","flex flex-row justify-between divide-x divide-primary w-full border border-primary bg-accent gap-x-base"),r(T,"class","flex flex-row flex-wrap gap-y-4 gap-x-6 text-sm text-primary"),r(l,"class","absolute inset-x-0 bottom-8 flex flex-col gap-y-6 w-full h-2/5 px-6 py-6 bg-accent")},m(a,_){F(a,l,_),c(l,t),c(t,e),W(e,s[3]),c(t,n),c(t,f),c(f,i),c(i,p),c(i,u),c(l,v),c(l,w),c(w,x),W(x,s[4]),c(w,E),c(w,L),c(L,y),c(y,D),c(y,I),c(l,B),c(l,T);for(let m=0;m<o.length;m+=1)o[m].m(T,null);P||(C=[Q(e,"input",s[13]),Q(f,"click",s[8]),Q(x,"input",s[14]),Q(L,"click",s[15])],P=!0)},p(a,_){if(_&8&&e.value!==a[3]&&W(e,a[3]),_&16&&x.value!==a[4]&&W(x,a[4]),_&576){k=a[6];let m;for(m=0;m<k.length;m+=1){const q=pe(a,k,m);o[m]?o[m].p(q,_):(o[m]=ve(q),o[m].c(),o[m].m(T,null))}for(;m<o.length;m+=1)o[m].d(1);o.length=k.length}},d(a){a&&h(l),we(o,a),P=!1,ye(C)}}}function ve(s){let l,t=s[19].name+"",e,n,f,i;function p(){return s[16](s[19])}return{c(){l=b("button"),e=H(t),n=O(),this.h()},l(u){l=g(u,"BUTTON",{class:!0});var v=d(l);e=R(v,t),n=U(v),v.forEach(h),this.h()},h(){r(l,"class","border border-primary py-1 px-2")},m(u,v){F(u,l,v),c(l,e),c(l,n),f||(i=Q(l,"click",p),f=!0)},p(u,v){s=u,v&64&&t!==(t=s[19].name+"")&&G(e,t)},d(u){u&&h(l),f=!1,i()}}}function Ce(s){let l,t,e,n,f,i,p,u,v,w,x,E,L,y,D,I,B,T;function P(a,_){return a[0]&&a[0].length?Pe:a[0].length==0?Be:Ne}let C=P(s),k=C(s),o=s[1]&&me(s);return{c(){l=b("main"),t=b("div"),e=b("input"),n=O(),f=b("button"),i=A("svg"),p=A("circle"),u=A("path"),v=O(),w=b("div"),k.c(),x=O(),E=b("div"),o&&o.c(),L=O(),y=b("button"),D=H("Filters"),this.h()},l(a){l=g(a,"MAIN",{class:!0});var _=d(l);t=g(_,"DIV",{class:!0});var m=d(t);e=g(m,"INPUT",{type:!0,name:!0,placeholder:!0,class:!0}),n=U(m),f=g(m,"BUTTON",{class:!0});var q=d(f);i=z(q,"svg",{viewBox:!0,fill:!0,xmlns:!0});var j=d(i);p=z(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),d(p).forEach(h),u=z(j,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0}),d(u).forEach(h),j.forEach(h),q.forEach(h),m.forEach(h),v=U(_),w=g(_,"DIV",{class:!0});var M=d(w);k.l(M),M.forEach(h),_.forEach(h),x=U(a),E=g(a,"DIV",{class:!0});var N=d(E);o&&o.l(N),L=U(N),y=g(N,"BUTTON",{class:!0});var V=d(y);D=R(V,"Filters"),V.forEach(h),N.forEach(h),this.h()},h(){r(e,"type","search"),r(e,"name","search-query"),r(e,"placeholder","Search for a story"),r(e,"class","flex-1 py-1 bg-primary text-sm px-2 focus:outline-none placeholder:text-black"),r(p,"cx","19"),r(p,"cy","19"),r(p,"r","7"),r(p,"stroke","#000002"),r(p,"stroke-width","1.5"),r(u,"d","M28 28L25 25"),r(u,"stroke","#000002"),r(u,"stroke-width","1.5"),r(u,"stroke-linecap","round"),r(i,"viewBox","0 0 40 40"),r(i,"fill","none"),r(i,"xmlns","http://www.w3.org/2000/svg"),r(f,"class","w-8 h-8 bg-primary focus:outline-none"),r(t,"class","flex flex-row justify-between w-full gap-x-base divide-x border"),r(w,"class","pb-4 flex flex-col gap-y-4"),r(l,"class","flex flex-col align-items-center gap-y-4 px-4 pb-4 overflow-y-scroll"),r(y,"class",I=s[1]?"absolute inset-x-0 bottom-0 w-full h-10 py-2 focus:outline-none bg-accent text-primary":"absolute inset-x-0 bottom-0 w-full h-10 py-2 focus:outline-none bg-primary border-t"),r(E,"class","flex flex-col divide-y")},m(a,_){F(a,l,_),c(l,t),c(t,e),W(e,s[2]),c(t,n),c(t,f),c(f,i),c(i,p),c(i,u),c(l,v),c(l,w),k.m(w,null),F(a,x,_),F(a,E,_),o&&o.m(E,null),c(E,L),c(E,y),c(y,D),B||(T=[Q(e,"input",s[11]),Q(f,"click",s[7]),Q(y,"click",s[17])],B=!0)},p(a,[_]){_&4&&W(e,a[2]),C===(C=P(a))&&k?k.p(a,_):(k.d(1),k=C(a),k&&(k.c(),k.m(w,null))),a[1]?o?o.p(a,_):(o=me(a),o.c(),o.m(E,L)):o&&(o.d(1),o=null),_&2&&I!==(I=a[1]?"absolute inset-x-0 bottom-0 w-full h-10 py-2 focus:outline-none bg-accent text-primary":"absolute inset-x-0 bottom-0 w-full h-10 py-2 focus:outline-none bg-primary border-t")&&r(y,"class",I)},i:X,o:X,d(a){a&&h(l),k.d(),a&&h(x),a&&h(E),o&&o.d(),B=!1,ye(T)}}}function Oe(s,l,t){let e,n;ie(s,ce,o=>t(5,e=o)),ie(s,xe,o=>t(6,n=o));let f,i,p=!1,u="",v="",w="";he.fetchNextPage(),he.subscribe(o=>{t(0,f=o.data),i=o.data});const x=o=>{t(2,u=u.toLowerCase()),t(0,f=i.filter(a=>a.title.toLowerCase().includes(u)||a.author_name.toLowerCase().includes(u)||a.location.toLowerCase().includes(u))),t(2,u="")},E=o=>{t(3,v=v.toLowerCase()),t(0,f=i.filter(a=>a.location.toLowerCase().includes(v))),t(3,v=""),t(1,p=!1)},L=o=>{o=o.toLowerCase(),t(0,f=[]),i.forEach(a=>{a.categories.map(m=>m.toLowerCase()).filter(m=>m.includes(o)).length>0&&f.push(a)}),t(4,w=""),t(1,p=!1)},y=o=>{ce.set([...e,o])};function D(){u=this.value,t(2,u)}const I=o=>y(o.id);function B(){v=this.value,t(3,v)}function T(){w=this.value,t(4,w)}return[f,p,u,v,w,e,n,x,E,L,y,D,I,B,T,()=>L(w),o=>L(o.name),()=>t(1,p=!p)]}class je extends Ee{constructor(l){super();De(this,l,Oe,Ce,Ie,{})}}export{je as default};
